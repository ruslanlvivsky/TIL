# DB Relations

## Foreign key

- 외래 키
- 관계형 데이터베이스에서 한 테이블의 필드 중 다른 테이블의 행을 식별할 수 있는 키
- 참조하는 테이블에서 1개의 키에 해당하고 이를 참조되는 측 테이블의 기본 키를 가리킨다
- 참조하는 테이블의 행 1개의 값은 참조되는 측 테이블의 행 값에 대응된다
- ㅊ마조하는 테이블의 행 여러 개가 참조되는 테이블의 동일한 행을 참조할 수 있다 

### 참조 무결성

키를 사용하여 부모 테이블의 유일한 값을 참조해야 한다 

### ForeignKey field 

- 1 : N 관계

```python
article = models.ForeignKey(Article, on_delete=models.CASCADE)
```

### on_delete

- 외래 키가 참조하는 객체가 사라졌을 때 외래 키를 가진 객체를 어떻게 처리할 지를 정의

- 데이터 무결성을 위해 매우 중요한 설정이다
- CASCADE - 부모 객체가 삭제 됐을 때 이를 참조하는 개체도 삭제

### 데이터 무결성

- 데이터 정확성과 일관성을 유지하고 보증하는 것을 가리키며 데이터베이스나  RDBMS 시스템의 중요한 기능임

### 무결성 제한의 유형

1. 개체 무결성

   PK 의 개념과 관련

   모든 테이블이 PK를 가져야 하며 PK로 선택된 열은 고유한 값이여야하고 빈 값은 혀용하지 않는다

2. 참조 무결성

   외래키 같이 데이터베이스의 특정 테이블의 PK 값을 참조하는 것

3. 도메인 무결성

   정의된 형식에서 관계형 데이터베이스의 모든 컬럼이 선언되도록 규정한다

   

### 1:N 관계 related manager

- 역참조 ('comment_set')
  - Article(1) -> Comment(N)	
  - 게시글에 몇 개의 댓글이 작성되었는지 Django ORM 이 보장할 수 없기 때문이다

- 참조 ('article')
  - Comment(N) -> Article(1)
  - 댓글의 경우 어떠한 댓글이든 반드시 자신이 참조하고 있는 게시글이 있다
  - 실제 ForeignKeyField 또한 Comment 클래스에서 작성된다 

